<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@200..800&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="icon" type="image/x-icon" href="images/favicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xtract Map Reforger</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        

        #imageTextBox {
            position: absolute;
            top: 10px;
            left: 10px;
            font-weight: bold;
            background-color: rgba(190, 189, 189, 0.5);
            border: 1px solid black;
            padding: 10px;
            z-index: 1001;
            font-family: Oxanium, sans-serif;
        }

        #imageTextBox img {
            vertical-align: middle;
            margin-right: 10px;
            height: 32px;

        }

        #imageTextBox button {
            width: 200px; 
            height: 37px !important;
            font-weight: bold;
            display: flex;
                flex-direction: row;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.5);
            border: none!important;
            padding: 5px;
            font-family: Oxanium, sans-serif;
            justify-content: space-between;
            cursor: pointer;
        }
        
        #imageTextBox button img {
            margin-right: 10px; /* Add some space between image and text */
        }

        #imageTextBox button span {
            text-align: center;
            flex-grow: 1; /* Allow the text to take up remaining space */
        }

        .darkbackground {
        background-color: black !important; /* Dark mode background color */
        }
        
        .dark {
        color:white !important;
        box-sizing: border-box;
        border: 1px solid white !important;
        background-color: black !important; /* Dark mode background color */
        }
        .darklegendbackground {
        color:white !important;
        box-sizing: border-box;
        border: 1px solid rgb(255, 255, 255) !important;
        background-color: rgba(130, 130, 130, 0.4) !important;
        }

        .darklegend {
        color:white !important;
        box-sizing: border-box;
        border: 1px solid white !important;
        background-color: rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-content-wrapper {
            padding: 1px;
            text-align: center;
            border-radius: 0px !important;
            font-weight: bold;
            font-size: 14px;
            font-family: Oxanium, sans-serif;
        }
        #visitor-counter-container {
            display: none;
        }
        .leaflet-control-mapSwitch {
            user-select: none;
            transform: scale(0.9) !important;
            padding: 6px 8px;
            background-color: white;
            border: 1px solid black;
            border-radius: 2px;
            font-size: 14px;
            font-weight: bold;
            font-family: Oxanium, sans-serif;
            cursor: pointer;
            position: absolute;
            align-items: center;
            justify-content: center; /* Center the text horizontally */
            top: 1%;
            right: 1%;
            transform: translateX(-50%);
            z-index: 1001; /* Ensure it's above the map */
        }
        .leaflet-control-mapSwitch label {
            display: flex;
            align-items: center;
            gap: 6px;
            width: 100%;
            justify-content: center;
        }
        .leaflet-control-custom {
            opacity: 0.5 !important; /* Adjust the opacity as needed */
            top: 30px;
        }
        .marker-label-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Center the label vertically and horizontally */
            display: flex;
            flex-direction: column; /* Stack label lines vertically */
        }
        .marker-label {
            color: white;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            font-size: 25px;
            line-height: 1;
            font-family: "Oxanium", sans-serif;
            font-weight: bold;
            text-align: center;
            white-space: nowrap;
            pointer-events: none;
            margin-bottom: 5px; /* Adjust as necessary */
        }
        .marker-icon {
            width: 32px;
            height: 32px;
        }
        .custom-icon-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .custom-icon-container .marker-label-container {
            position: absolute;
            top: -60px; /* Adjust this value to move the label above the marker icon */
            left: 50%;
            transform: translateX(-50%);
        }
        .toast {
            visibility: hidden;
            position: fixed;
            bottom: 10px;
            font-family: Oxanium, sans-serif;
            left: 50%;
            transform: translateX(-50%);
            border: 1px solid #000000;
            background-color: #ffffff;
            color: #000000;
            text-align: center;
            padding: 15px;
            border-radius: 0px;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .toast.show {
            visibility: visible;
            opacity: 1;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%; /* Set the height to 100% of the viewport height */
            width: 100%;
            background-color: white;
        }
        .dark-mode #map {
            background-color: black !important;
        }
        .leaflet-control-darkmode {
            justify-content: center !important;
            user-select: none;
            transform: scale(0.9) !important;
            padding: 6px 8px;
            background-color: white;
            border: 1px solid black;
            border-radius: 2px;
            font-size: 14px;
            font-weight: bold;
            font-family: Oxanium, sans-serif;
            cursor: pointer;
            position: absolute;
            align-items: center;
            justify-content: center; /* Center the text horizontally */
            bottom: 90.5px;
            left: 15px;
            transform: translateX(-50%);
            z-index: 1001; /* Ensure it's above the map */
        }
        .leaflet-control-darkmode.dark-mode {
            background-color: black;
            color: white;
        }
        .leaflet-control-darkmode.dark-mode span {
            margin-right: 6px;
        }
        .leaflet-control-legend {
            justify-content: center !important;
            user-select: none;
            transform: scale(0.9) !important;
            padding: 6px 8px;
            background-color: white;
            border: 1px solid black;
            border-radius: 2px;
            font-size: 14px;
            font-weight: bold;
            font-family: Oxanium, sans-serif;
            cursor: pointer;
            position: absolute;
            align-items: center;
            justify-content: center; /* Center the text horizontally */
            bottom: 125px;
            left: 14px;
            transform: translateX(-50%);
            z-index: 1001; /* Ensure it's above the map */
        }
        .leaflet-control-legend.dark-mode {
            background-color: black;
            color: white;
        }
        .leaflet-control-legend.dark-mode span {
            margin-right: 6px;
        }

        .leaflet-control-darkmode label, .leaflet-control-legend label {
            display: flex;
            align-items: center;
            gap: 6px;
            width: 100%;
            justify-content: center;
        }
        .legend-container img {
            max-height: 260px !important; /* Adjust as needed */
            max-width: 100%; /* Adjust as needed */

        }
        .leaflet-bottom.leaflet-left {
            margin: 10px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <!-- Checkbox input for dark mode -->
    <div class="leaflet-control-darkmode">
        <label for="darkModeSwitch">
            <span>Dark Mode</span>
            <input type="checkbox" id="darkModeSwitch">
        </label>
    </div>

    <!-- Checkbox input for legend toggle -->
    <div class="leaflet-control-legend">
    <label for="legendSwitch">
        <span>Show Legend</span>
        <input type="checkbox" id="legendSwitch" checked>
    </label>
</div>



    <!-- Visitor counter container with box-like appearance -->
    <div id="visitor-counter-container">
        <script type="text/javascript" src="https://www.free-counters.org/count/fn1o"></script><br>
        <a href='https://www.free-counters.org/'>Counter</a> <script type='text/javascript' src='https://whomania.com/ctr?id=a16d7270463374772100b267a326c06c3cf169fb'></script>
    </div>

    <div class="leaflet-control-mapSwitch">
        <label for="mapImageSwitch">
            <span>Switch Map</span>
            <input type="checkbox" id="mapImageSwitch">
        </label>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toastNotification"></div>


    <!-- <div id="imageTextBox">
        <div>
            <img src="images/Extract.png" alt="Icon 1" style="width: 32px; height: 32px;">
            <label class="checkbox-label">
                Marker 1
                <input type="checkbox" id="checkboxIcon1" onchange="toggleMarkersByImage('images/Extract.png')" checked>
                <span class="checkmark"></span>
            </label>
        </div>
        <div>
            <img src="images/PExtract.png" alt="Icon 2">
            <label class="checkbox-label">
                Marker 2
                <input type="checkbox" id="checkboxIcon2" onchange="toggleMarkersByImage('images/PExtract.png')" checked>
                <span class="checkmark"></span>
            </label>
        </div>
        <div>
            <img src="images/helicrash.png" alt="Icon 3">
            <label class="checkbox-label">
                Marker 3
                <input type="checkbox" id="checkboxIcon3" onchange="toggleMarkersByImage('images/helicrash.png')" checked>
                <span class="checkmark"></span>
            </label>
        </div>
        <button onclick="toggleAllMarkers()">Toggle All</button>
    </div> -->

    <div id="imageTextBox">
        <button onclick="toggleMarkersByImage('images/Extract.png')" data-image-url="images/Extract.png" data-checkbox-id="checkbox1">
            <img src="images/Extract.png" alt="Icon 1">
            <span>Extract</span>
            <input type="checkbox" id="checkbox1" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/PExtract.png')" data-image-url="images/PExtract.png" data-checkbox-id="checkbox2">
            <img src="images/PExtract.png" alt="Icon 2">
            <span>Paid Extract</span>
            <input type="checkbox" id="checkbox2" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/helicrash.png')" data-image-url="images/helicrash.png" data-checkbox-id="checkbox3">
            <img src="images/helicrash.png" alt="Icon 3">
            <span>Helicrash</span>
            <input type="checkbox" id="checkbox3" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/atc.png')" data-image-url="images/atc.png" data-checkbox-id="checkbox4">
            <img src="images/atc.png" alt="Icon 4">
            <span>ATC Tower</span>
            <input type="checkbox" id="checkbox4" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/factory.png')" data-image-url="images/factory.png" data-checkbox-id="checkbox5">
            <img src="images/factory.png" alt="Icon 5">
            <span>Factory</span>
            <input type="checkbox" id="checkbox5" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/tent.png')" data-image-url="images/tent.png" data-checkbox-id="checkbox6">
            <img src="images/tent.png" alt="Icon 6">
            <span>Military Tent</span>
            <input type="checkbox" id="checkbox6" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/tier1.png')" data-image-url="images/tier1.png" data-checkbox-id="checkbox7">
            <img src="images/tier1.png" alt="Icon 7">
            <span>Tier 1 Boss</span>
            <input type="checkbox" id="checkbox7" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/tier2.png')" data-image-url="images/tier2.png" data-checkbox-id="checkbox8">
            <img src="images/tier2.png" alt="Icon 8">
            <span>Tier 2 Boss</span>
            <input type="checkbox" id="checkbox8" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/tier3.png')" data-image-url="images/tier3.png" data-checkbox-id="checkbox9">
            <img src="images/tier3.png" alt="Icon 9">
            <span>Tier 3 Boss</span>
            <input type="checkbox" id="checkbox9" checked>
        </button>
        <button onclick="toggleMarkersByImage('images/military.png')" data-image-url="images/military.png" data-checkbox-id="checkbox10">
            <img src="images/military.png" alt="Icon 10">
            <span>Military Loot</span>
            <input type="checkbox" id="checkbox10" checked>
        </button>
        <button onclick="toggleAllMarkers()" style="margin-top: 10px; text-align: center; display: block; width: 100%;">Toggle All</button>
    </div>
    

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>

// Add event listeners to checkboxes to toggle marker visibility
document.querySelectorAll('input[type="checkbox"]').forEach(function(checkbox) {
    checkbox.addEventListener('change', function() {
        var imageUrl = this.parentNode.getAttribute('data-image-url');
        toggleMarkersByImage(imageUrl, this.checked);
    });
});

// Function to toggle all markers
function toggleAllMarkers() {
    var buttons = document.querySelectorAll("#imageTextBox button");
    buttons.forEach(function(button) {
        var checkboxId = button.getAttribute("data-checkbox-id");
        var checkbox = document.getElementById(checkboxId);
        var imageUrl = button.getAttribute("data-image-url");

        // Hide or show the marker based on the checkbox state
        toggleMarkersByImage(imageUrl, !checkbox.checked);

        // Update the checkbox state
        checkbox.checked = !checkbox.checked;
    });
}


    
    //var imageUrl = 'Arland-map-HQ.png';
    var imageUrl1 = 'images/Arland-map-HQ Test.png';
    var imageUrl2 = 'images/Arland-map-HQ.png';
    var imageBounds = [[0, 0], [6456, 7272]]; // Image size: height x width 6456, 7272
    var imageLimit = [[0, 0], [6456, 7272]];

    // Calculate the aspect ratio of the image
    var aspectRatio = 7272 / 6456;

    // Calculate the maximum width and height of the map to maintain the aspect ratio
    var maxWidth = window.innerWidth;
    var maxHeight = window.innerHeight;

    if (maxWidth / maxHeight > aspectRatio) {
        maxWidth = maxHeight * aspectRatio;
    } else {
        maxHeight = maxWidth / aspectRatio;
    }

    var map = L.map('map', {
        maxZoom: 4,
        minZoom: -2.8,
        setZoom: 20,
        zoomSnap: 0,
        wheelPxPerZoomLevel: 70,
        maxBoundsViscosity: 1.0,
        maxBounds: imageBounds,
        crs: L.CRS.Simple,
        zoomControl: false
    }).setView([0, 0], -5);

    map.attributionControl.addAttribution('Site By Lucaboox <a href="https://ko-fi.com/lucaboox" target="_blank">Donate</a>');

    var currentImage = imageUrl1;
        var imageOverlay = L.imageOverlay(currentImage, imageBounds).addTo(map);
        map.setMaxBounds(imageLimit); // Restrict the map to the size of the image
        map.on('drag', function () {
            map.panInsideBounds(imageLimit, { animate: false });
        });

    // Add zoom control to bottom left
    var customZoomControl = L.control.zoom({ position: 'bottomleft', select: 'none' }).addTo(map);

        

        // Dark and Light mode
        function Darkmode () {
            document.getElementById('map').classList.add('darkbackground');
            document.querySelector('div#toastNotification').classList.add('dark');
            document.querySelector('.leaflet-control-zoom-in').classList.add('dark');
            document.querySelector('.leaflet-control-zoom-out').classList.add('dark');
            document.querySelector('.leaflet-control-mapSwitch').classList.add('dark');
            document.querySelector('.leaflet-control-darkmode').classList.add('dark');
            document.querySelector('.leaflet-control-legend').classList.add('dark');
            document.querySelector('.leaflet-control-attribution.leaflet-control').classList.add('dark');
            document.querySelector('rect').style.fill = '#000000';

            document.getElementById('imageTextBox').classList.add('darklegendbackground');
            document.querySelectorAll("#imageTextBox button").forEach(function(button) {
            button.classList.add('darklegend');
        });



            map.on('popupopen', function (e) {
                var elements = e.popup._container.querySelectorAll('.leaflet-popup-content-wrapper, .leaflet-popup-tip');
                elements.forEach(function(element) {
                    element.classList.add('dark');
                });
            });
        
        }
        function Lightmode () {
            document.getElementById('map').classList.remove('darkbackground');
            document.querySelector('div#toastNotification').classList.remove('dark');
            document.querySelector('.leaflet-control-zoom-in').classList.remove('dark');
            document.querySelector('.leaflet-control-zoom-out').classList.remove('dark');
            document.querySelector('.leaflet-control-mapSwitch').classList.remove('dark');
            document.querySelector('.leaflet-control-darkmode').classList.remove('dark');
            document.querySelector('.leaflet-control-legend').classList.remove('dark');
            document.querySelector('rect').style.fill = '#111111';

            document.getElementById('imageTextBox').classList.remove('darklegendbackground');
            document.querySelectorAll("#imageTextBox button").forEach(function(button) {
            button.classList.remove('darklegend');
        });


            map.on('popupopen', function (e) {
                var elements = e.popup._container.querySelectorAll('.leaflet-popup-content-wrapper, .leaflet-popup-tip');
                elements.forEach(function(element) {
                    element.classList.remove('dark');
                });
            });
        }
        


    // Retrieve dark mode setting from local storage
    var darkModeEnabled = localStorage.getItem('darkModeEnabled');
    if (darkModeEnabled === 'true') {
        
        Darkmode();
        document.getElementById('darkModeSwitch').checked = true;
    }

    // Event listener for dark mode switch
    document.getElementById('darkModeSwitch').addEventListener('change', function (event) {
        if (event.target.checked) {
            Darkmode();
            showToast('Dark mode enabled');
            localStorage.setItem('darkModeEnabled', 'true');
        } else {
            Lightmode();
            showToast('Dark mode disabled');
            localStorage.setItem('darkModeEnabled', 'false');
        }
    });

    // Event listener for legend toggle switch
    document.getElementById('legendSwitch').addEventListener('change', function (event) {
        var imageTextBox = document.getElementById('imageTextBox');
        if (event.target.checked) {
            imageTextBox.style.display = 'block';
            localStorage.setItem('legendEnabled', 'true');
        } else {
            imageTextBox.style.display = 'none';
            localStorage.setItem('legendEnabled', 'false');
        }
    });

    // Retrieve legend visibility setting from local storage
    var legendEnabled = localStorage.getItem('legendEnabled');
    if (legendEnabled === 'false') {
        document.getElementById('imageTextBox').style.display = 'none';
        document.getElementById('legendSwitch').checked = false;
    }



    // Define the Vistor Control
    var visitorCounterControl = L.control({position: 'bottomright'});

        // Add the HTML to the control
        visitorCounterControl.onAdd = function(map) {
            var container = L.DomUtil.create('div', 'leaflet-control-custom');
            container.innerHTML = document.getElementById('visitor-counter-container').innerHTML;
            return container;
        };

        // Add the control to the map
        visitorCounterControl.addTo(map);


        // Get the checkbox element
        var mapImageSwitch = document.getElementById('mapImageSwitch');

        // Load the saved state from localStorage
        var isMapSwitched = localStorage.getItem('isMapSwitched');

        // If there's a saved state, apply it
        if (isMapSwitched !== null) {
            mapImageSwitch.checked = (isMapSwitched === 'true');
        }

        // Decide which image to use based on the checkbox state
        var currentImage = mapImageSwitch.checked ? imageUrl2 : imageUrl1;

        // Create the map and image overlay here, using `currentImage` for the overlay
        var imageOverlay = L.imageOverlay(currentImage, imageBounds).addTo(map);

        // Add an event listener to the checkbox to save its state whenever it's changed
        mapImageSwitch.addEventListener('change', function(event) {
            if (event.target.checked) {
                currentImage = imageUrl2;
            } else {
                currentImage = imageUrl1;
            }
            map.removeLayer(imageOverlay);
            imageOverlay = L.imageOverlay(currentImage, imageBounds).addTo(map);

            // Save the state to localStorage
            localStorage.setItem('isMapSwitched', event.target.checked);
        });
    </script>

</script>

<script>
    // Load markers data from markers.txt
    $(document).ready(function() {
        $.ajax({
            url: 'markers.txt',
            dataType: 'text',
            success: function(data) {
                createMarkersAndLinesFromData(data);
            }
        });
    });

    // Calculate the number of line breaks in the label
    function countLineBreaks(labelText) {
        return labelText.split("<br>").length - 1;
    }

    // Function to adjust marker label position based on line breaks
    function adjustMarkerLabelPosition(marker) {
        var markerLabel = marker.getElement().querySelector('.marker-label-container');
        var numLineBreaks = countLineBreaks(marker.options.labelText);
        var offset = 25 * numLineBreaks; // Adjust this value as needed
        markerLabel.style.top = `calc(-110% - ${offset}px)`; // Adjust label position
    }

    // Function to extract text within quotes
    function getTextWithinQuotes(str) {
        var matches = str.match(/"([^"]*)"/);
        return matches ? matches[1] : str;
    }

    // Variable to track marker visibility state
    var markersVisible = true;



        // Add event listeners to the buttons
document.querySelectorAll("#imageTextBox button").forEach(button => {
    button.addEventListener("click", function() {
        const checkboxId = this.getAttribute("data-checkbox-id");
        const checkbox = document.getElementById(checkboxId);
        if (checkbox) {
            checkbox.checked = !checkbox.checked;
        }
    });
});

    var markersByImage = {};

    // Function to toggle markers by image URL
function toggleMarkersByImage(imageUrl) {
    console.log('Toggling markers for image URL:', imageUrl);
    console.log('Available keys in markersByImage:', Object.keys(markersByImage));

    var layerGroup = markersByImage[imageUrl];

    if (layerGroup) {
        if (map.hasLayer(layerGroup)) {
            map.removeLayer(layerGroup);
        } else {
            map.addLayer(layerGroup);
        }
    } else {
        console.log('No layer group found for image URL:', imageUrl);
    }
}


// Function to create markers and lines from data
function createMarkersAndLinesFromData(data) {
    var lines = data.split('\n');
    for (var i = 0; i < lines.length; i++) {
        var parts = lines[i].split(',');
        var lat = parseFloat(parts[0]);
        var lng = parseFloat(parts[1]);
        var iconUrl = parts[2];
        var popupText = getTextWithinQuotes(parts[3]);
        var labelText = getTextWithinQuotes(parts[4]);
        var imageUrl = parts[5];
        var destLat = parseFloat(parts[6]);
        var destLng = parseFloat(parts[7]);
        var labelOffsetX = parseInt(parts[8]); // Parse label offset X
        var labelOffsetY = parseInt(parts[9]); // Parse label offset Y
        var scale = parseFloat(parts[12]); // Parse scale

        var customIconOptions = {
            html: `<div class="custom-icon-container">
                    <div class="marker-label-container" style="transform: translate(${labelOffsetX}px, ${labelOffsetY}px);"> <!-- Apply label offset -->
                        <div class="marker-label">${labelText}</div>
                    </div>
                    <div class="marker-icon-wrapper" style="transform: scale(${scale});"> <!-- Apply scale transformation -->
                        <img src="${iconUrl}" class="marker-icon">
                    </div>
                </div>`,
            iconSize: [32, 32], // Set default icon size
            iconAnchor: [16, 16], // Adjust icon anchor to the bottom of the icon
            popupAnchor: [0, -32], // Adjust popup anchor as needed
            className: '' // Remove default class to avoid default styling
        };

        var customIcon = L.divIcon(customIconOptions);

        // Add image to the popup text only if iconUrl is defined and not empty
        var popupContent = `<div>${popupText}</div>`;
        if (imageUrl && imageUrl.trim() !== '') {
            //popupContent += `<div><img src="${imageUrl}" alt="Image" style="width:380px;height:auto;"></div>`;
            popupContent += `<div class="image-container"><img src="${imageUrl}" alt="Image" style="width:380px;height:auto;"></div>`;
        }

        var marker = L.marker([lat, lng], {
            icon: customIcon
        }).addTo(map);

        var popup = L.popup({
        maxWidth: 900 // Set the maximum width to 500 pixels
        }).setContent(popupContent);

        
    
        marker.bindPopup(popup);


           // Initialize layer group if not already done
if (!markersByImage[iconUrl]) {
    markersByImage[iconUrl] = L.layerGroup(); // Naming the layer group after the icon URL
    markersByImage[iconUrl].addTo(map); // Add the layer group to the map
}

markersByImage[iconUrl].addLayer(marker);

        if (!isNaN(destLat) && !isNaN(destLng)) {
            var line = L.polyline([[lat, lng], [destLat, destLng]], { color: 'black' });
            markersByImage[iconUrl].addLayer(line);
        }
    }

    // Add all layer groups to the map initially
    for (var key in markersByImage) {
        markersByImage[key].addTo(map);
    }
}

                // Variables to store latitude and longitude
                var cursorLat, cursorLng;

// Event listener for mousemove event to update cursor latitude and longitude
map.on('mousemove', function(event) {
    cursorLat = event.latlng.lat.toFixed(6);
    cursorLng = event.latlng.lng.toFixed(6);
});

// Function to show toast notification
function showToast(message) {
    var toast = document.getElementById('toastNotification');
    toast.innerHTML = message;
    toast.classList.add('show');
    setTimeout(function() {
        toast.classList.remove('show');
    }, 3000); // 3000 milliseconds (3 seconds) for the notification to disappear
}

// Event listener for keydown event
document.addEventListener('keydown', function(event) {
    // Check if the pressed key is "Q" (key code 81)
    if (event.keyCode === 81) {
        // Check if cursorLat and cursorLng are defined
        if (typeof cursorLat !== 'undefined' && typeof cursorLng !== 'undefined') {
            // Copy latitude and longitude to clipboard
            var coordinates = cursorLat + ', ' + cursorLng;
            
            // Create a temporary textarea element to copy text to clipboard
            var textarea = document.createElement('textarea');
            textarea.value = coordinates;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            // Show toast notification that coordinates are copied
            showToast('Latitude and longitude copied to clipboard: ' + coordinates);
        } else {
            // Show toast notification that cursor coordinates are not available
            showToast('Cursor coordinates are not available. Move the mouse over the map to get coordinates.');
        }
    }
});
    </script>
</body>
</html>



